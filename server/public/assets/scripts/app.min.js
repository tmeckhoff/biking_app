/*! biking_app 2015-09-06 */
var myApp=angular.module("myApp",["ngRoute"]);console.log("In the app.js"),myApp.config(["$routeProvider",function(a){a.when("/home",{templateUrl:"/assets/views/routes/home.html",controller:"firstController"}).otherwise({redirectTo:"/home"})}]),myApp.controller("firstController",["$rootScope","$scope","$http",function(a,b,c){b.ratings=[],b.Rating=function(a,b,c,d,e,f,g){this.latitude=e,this.longitude=f,this.comment=d,this.name=a,this.title=b,this.rating=c,this.id=g},b.sendRating=function(){return c.post("/rating",{name:b.name,title:b.title,rating:b.rating,comment:b.comment,latitude:b.latitude,longitude:b.longitude}).success(function(a){b.name="",b.title="",b.rating="",b.comment="",b.successMessage="You rated it!",b.showSuccessMessage=!0,b.refreshRatings()})},b.refreshRatings=function(){c.get("/rating").success(function(a){b.ratings=[];for(var c=0,d=a.length;d>c;c++)b.r=a[c],b.ratings.push(new b.Rating(b.r.name,b.r.title,b.r.rating,b.r.comment,b.r.latitude,b.r.longitude,b.r._id));console.log(b.ratings),b.ratings.forEach(function(a,c){b.marker=new google.maps.Marker({draggable:!1,position:new google.maps.LatLng(a.latitude,a.longitude),map:b.map,animation:google.maps.Animation.DROP,icon:"../assets/styles/images/cycling.png"}),b.infowindow=new google.maps.InfoWindow({content:'<div class="info-box"><h5>'+a.name+" said the following about this spot:</h5><p>"+a.title+"</p><br/><p>Rated it: "+a.rating+"</p><br/><p>"+a.comment+"</p><br/></div>"}),google.maps.event.addListener(b.marker,"click",function(){b.infowindow.open(b.map,b.marker)})})})},a.$on("hideMessages",function(){b.$apply(function(){b.showSuccessMessage=!1})}),b.refreshRatings(),b.map=new google.maps.Map(document.getElementById("map"),{zoom:13,center:{lat:44.970697,lng:-93.2614785},mapTypeId:google.maps.MapTypeId.ROADMAP});var d=[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]}];b.map.setOptions({styles:d}),b.marker,google.maps.event.addListener(b.map,"click",function(c){b.marker=new google.maps.Marker({draggable:!1,position:c.latLng,map:b.map,animation:google.maps.Animation.DROP,icon:"../assets/styles/images/cycling.png"}),a.$broadcast("hideMessages"),b.latitude=b.marker.getPosition().lat(),b.longitude=b.marker.getPosition().lng()})}]);